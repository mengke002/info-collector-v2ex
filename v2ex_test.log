2025-08-12 14:56:07,731 - src.scheduler - INFO - 开始执行增量爬取任务
2025-08-12 14:56:07,739 - src.database - ERROR - 数据库连接失败: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 97] Address family not supported by protocol)")
2025-08-12 14:56:07,739 - src.database - ERROR - 数据库操作失败: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 97] Address family not supported by protocol)")
2025-08-12 14:56:07,739 - src.scheduler - ERROR - 爬取任务失败: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 97] Address family not supported by protocol)")
Traceback (most recent call last):
  File "/home/jules/.pyenv/versions/3.12.11/lib/python3.12/site-packages/pymysql/connections.py", line 649, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jules/.pyenv/versions/3.12.11/lib/python3.12/socket.py", line 865, in create_connection
    raise exceptions[0]
  File "/home/jules/.pyenv/versions/3.12.11/lib/python3.12/socket.py", line 845, in create_connection
    sock = socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jules/.pyenv/versions/3.12.11/lib/python3.12/socket.py", line 233, in __init__
    _socket.socket.__init__(self, family, type, proto, fileno)
OSError: [Errno 97] Address family not supported by protocol

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/src/scheduler.py", line 32, in run_crawl_task
    db_manager.init_database()
  File "/app/src/database.py", line 209, in init_database
    with self.get_cursor() as (cursor, connection):
         ^^^^^^^^^^^^^^^^^
  File "/home/jules/.pyenv/versions/3.12.11/lib/python3.12/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/app/src/database.py", line 100, in get_cursor
    connection = self.get_connection()
                 ^^^^^^^^^^^^^^^^^^^^^
  File "/app/src/database.py", line 79, in get_connection
    connection = pymysql.connect(
                 ^^^^^^^^^^^^^^^^
  File "/home/jules/.pyenv/versions/3.12.11/lib/python3.12/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
  File "/home/jules/.pyenv/versions/3.12.11/lib/python3.12/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 97] Address family not supported by protocol)")
